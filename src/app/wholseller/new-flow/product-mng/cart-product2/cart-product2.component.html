<section class="content">
    <div class="content-block">
      <h4 class="mt-4"><i class="bi bi-person-vcard-fill h3"></i>&nbsp; Products in Your Cart</h4>
  
       <!-- If products are available, display the accordion -->
    <p-accordion [activeIndex]="0" class="card" *ngIf="products && products.length > 0">
      <ng-container *ngFor="let prod of products">
        <p-accordionTab class="px-0">
          <ng-template pTemplate="header">
            <div class="d-flex justify-content-between align-items-center w-100">
              <div class="text-primary fw-bold">
                {{ prod.manufacturer.fullName }} —
                Total Items: {{ getTotalQuantity(prod) | number:'1.0-0' }} |
                Total Amount: ₹ {{ getTotalAmount(prod) | indianCurrency }}

              </div>
              <button class="btn btn-sm btn-danger" (click)="confirmDeleteCart(prod)">
                <i class="bi bi-trash-fill"></i> Delete All
              </button>
            </div>
          </ng-template>        
          
          <div  class="mb-4">
    
            <!-- wrapper that lets only sizes scroll -->
            <div class="table-wrapper">
              <p-table [value]="prod.set" [responsive]="true" [paginator]="false" [style]="{ 'table-layout': 'auto' }">
                <ng-template pTemplate="header">
                  <tr>
                    <th>Sr. No.</th>
                    <th>Design No.</th>
                    <th>Colour Name</th>
                    <th>Image</th>
                    <th>Size</th>
                    <th>Rate (₹)</th>
                    <th>Quantity</th>
                    <th>Total Price (₹)</th>
                    <th>Action</th>
                  </tr>
                </ng-template>
            
                <ng-template pTemplate="body" let-item let-i="rowIndex">
                  <tr>
                    <td>{{ i + 1 }}</td>
                    <td>{{ item.designNumber }}</td>
                    <td>{{ item.colourName }}</td>
                    <td>
                      <img [src]="item.colourImage" alt="Colour Image" style="width: 50px; height: 50px; object-fit: cover;" />
                    </td>
                    <td>{{ item.size }}</td>
                    <td>{{ item.price | indianCurrency}}</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ item.price * item.quantity | indianCurrency}}</td>
                    <td>
                      <button class="btn btn-sm btn-primary me-2"  (click)="onEdit(item, prod._id)">
                        <i class="bi bi-pencil-fill"></i>
                      </button>
                      <button class="btn btn-sm btn-danger" (click)="onDelete(item, prod._id)" >
                        <i class="bi bi-trash-fill"></i>
                      </button>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
    
          </div>
    
          <hr />
          <div class="d-flex align-items-center">
            <button class="btn btn-success mx-auto" (click)="placeOrder(prod)">
              <i class="bi bi-cart-check"></i> Purchase Order
            </button>
          </div>
    
        </p-accordionTab>
      </ng-container>
    </p-accordion>
    

      
      <!-- Display no data found -->
      <!-- <div *ngIf="!processedProducts || processedProducts.length === 0" class="no-data-found">
        <p>No data found</p>
      </div> -->
      <div *ngIf="!products" class="text-center data-not-found ">
       <p>Cart Data Not Found [Server Error]</p>
      </div>
      <div *ngIf="products.length === 0" class=" text-center data-not-found mb-12">
        <p>Your Cart is Empty</p>
      </div>
      
      <div class="mb-3">
        <app-bottom-side-advertise [imageUrl]="bottomAdImage"></app-bottom-side-advertise>
      </div>
    </div>
  </section>
  