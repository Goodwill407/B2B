<section class="content">
    <div class="content-block">
      
        <div class="flex-grow-1">
          <h4 class="mt-4"><i class="bi bi-person-vcard-fill h3"></i>&nbsp; Wholesaler Order List </h4>
 
          @if(products && products.length >0){
          <p-accordion [activeIndex]="0" class="card">
            <ng-container *ngFor="let distributor of products; let distIndex = index">
              <p-accordionTab class="px-0" [header]="'Wholesaler : ' + distributor.buyerDetails">
                <!-- Table for Products of Each Manufacturer -->
                <p-table [value]="distributor.products">
                  <ng-template pTemplate="header">
                    <tr>
                      <th>Sr No.</th>
                      <th>Design No.</th>
                      <th>Title</th>
                      <th>Qty</th>
                      <th>Rate</th>
                      <th>Delivery Qty</th>
                      <th>Amount</th>                  
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-product let-index="rowIndex">
                    <tr>
                      <td>{{ index + 1 }}</td>
                      <td>{{ product.designNo }}</td>
                      <td>{{ product.name }}</td>                      
                      <td>{{ product.qty }}</td>             
                      <td>{{ product.rate }}</td>
                      <td style="width: 100px;">
                        <input type="number" class="w-75" [(ngModel)]="product.qty"
                          (change)="updateQuantity($event, distributor, product)">
                      </td>
                      <td>{{ product.quantity * product.setOfManPrice }}</td>
                      
                    </tr>
                  </ng-template>
                </p-table>
                <hr>
                <div class="d-flex align-items-center">
                  <div class="totals">
                    <p class="mb-1 fw-bold">Sub Total : {{ distributor.subTotal }}</p>
                    <p class="mb-1 fw-bold">GST (18%) : {{ distributor.gst }}</p>
                    <p class="mb-1 fw-bold">Grand Total : {{ distributor.grandTotal }}</p>
                  </div>
                  <button class="btn btn-success mx-auto" (click)="placeOrder(distributor)">
                    <i class="bi bi-cart-check"></i> Generate Deliver Challan
                  </button>
                </div>
              </p-accordionTab>
            </ng-container>
          </p-accordion>
          }@else {
          <div class="text-danger m-5 fw-6">
            No products found for this Wholesaler.
          </div>
          }
  
        </div>  
    </div>
  </section>