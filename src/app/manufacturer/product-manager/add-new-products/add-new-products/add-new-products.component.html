<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="default" color="#fff" type="square-jelly-box" [fullScreen]="true">
    <p style="color: rgb(242, 94, 94)"> Loading... </p>
</ngx-spinner>
<section class="content">
    <div class="content-block">
        <h4 class="mt-4"><i class="bi bi-person-vcard-fill h3"></i> Add New Product</h4>
        <div class="card p-4">

            <form [formGroup]="addProductForm">
                <!-- Step 1 -->
                <div *ngIf="currentStep === 1" [formGroup]="stepOne">
                    <div class="row">
                        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                            <label class="label-input" for="designNumber">Design No.<span
                                    class="required">*</span></label>
                            <input type="text" id="designNumber" formControlName="designNumber" class="form-control"
                                [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('designNumber')?.invalid}">
                            <div *ngIf="submittedStep1 && stepOne.get('designNumber')?.invalid"
                                class="invalid-feedback">
                                <div *ngIf="stepOne.get('designNumber')?.hasError('required')">
                                    Design No. is required
                                </div>
                            </div>
                        </div>

                        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                            <label class="label-input" for="brand">Brand<span class="required">*</span></label>
                            <select name="brand" id="brand" class="form-select" formControlName="brand"
                                [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('brand')?.invalid}">
                                <option value="" disabled>Select</option>
                                <option *ngFor="let type of allBrands" [value]="type">
                                    {{ type }}
                                </option>
                            </select>
                            <!-- Validation feedback for the Brand field -->
                            <div *ngIf="submittedStep1 && stepOne.get('brand')?.invalid" class="invalid-feedback">
                                <div *ngIf="stepOne.get('brand')?.hasError('required')">
                                    Brand is required
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12">
                            <label class="label-input" for="productTitle">Product Title<span
                                    class="required">*</span></label>
                            <input type="text" id="productTitle" formControlName="productTitle" class="form-control"
                                [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('productTitle')?.invalid}">
                            <div *ngIf="submittedStep1 && stepOne.get('productTitle')?.invalid"
                                class="invalid-feedback">
                                <div *ngIf="stepOne.get('productTitle')?.hasError('required')">
                                    Product Title is required
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12">
                            <label class="label-input" for="productDescription">Product Description<span
                                    class="required">*</span></label>
                            <textarea name="productDescription" id="productDescription" class="form-control"
                                formControlName="productDescription"
                                [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('productDescription')?.invalid}"></textarea>
                            <div *ngIf="submittedStep1 && stepOne.get('productDescription')?.invalid"
                                class="invalid-feedback">
                                <div *ngIf="stepOne.get('productDescription')?.hasError('required')">
                                    Product Description is required
                                </div>
                            </div>
                        </div>
                    </div>
                    <h5 class="mb-2 ps-0">Product Details</h5>
                    <div class="card p-2">
                        <div class="row mt-2">
                            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="productType">Product Type<span
                                        class="required">*</span></label>
                                <select name="productType" id="productType" class="form-select"
                                    formControlName="productType"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('productType')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allProductType" [value]="type.name">{{ type.name }}
                                    </option>
                                </select>
                                <!-- Validation feedback -->
                                <div *ngIf="submittedStep1 && stepOne.get('productType')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('productType')?.hasError('required')">
                                        Product Type is required
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="gender">Gender<span class="required">*</span></label>
                                <select name="gender" id="gender" class="form-select" formControlName="gender"
                                    (change)="getCategoryByProductTypeAndGender()"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('gender')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="gender" *ngFor="let gender of allGender">{{gender}}</option>
                                </select>
                                <!-- Validation feedback -->
                                <div *ngIf="submittedStep1 && stepOne.get('gender')?.invalid" class="invalid-feedback">
                                    <div *ngIf="stepOne.get('gender')?.hasError('required')">
                                        Gender is required
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="clothing">Category<span
                                        class="required">*</span></label>
                                <select name="clothing" id="clothing" class="form-select" formControlName="clothing"
                                    (change)="getSubCategoryBYProductType_Gender_and_Category()"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('clothing')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="clothing" *ngFor="let clothing of allClothingType">
                                        {{clothing}}
                                    </option>
                                </select>
                                <!-- Validation feedback -->
                                <div *ngIf="submittedStep1 && stepOne.get('clothing')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('clothing')?.hasError('required')">
                                        Clothing is required
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="subCategory">Sub Category<span
                                        class="required">*</span></label>
                                <select name="subCategory" id="subCategory" class="form-select"
                                    formControlName="subCategory" (change)="checkAllFieldsSelected()"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('subCategory')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="subCategory" *ngFor="let subCategory of allSubCategory">
                                        {{subCategory}}
                                    </option>
                                </select>
                                <!-- Validation feedback -->
                                <div *ngIf="submittedStep1 && stepOne.get('subCategory')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('subCategory')?.hasError('required')">
                                        Sub Category is required
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- @if(showFlag){ -->
                        <div class="row mt-2">
                            <div *ngIf="visibleFields.includes('material')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="material">Material<span
                                        class="required">*</span></label>
                                <select name="material" id="material" class="form-select" formControlName="material"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('material')?.invalid}">
                                    <option value="" disabled>Select</option>
                                    <option *ngFor="let type of allMaterialType" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <!-- Validation feedback for the Material field -->
                                <div *ngIf="submittedStep1 && stepOne.get('material')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('material')?.hasError('required')">
                                        Material is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="visibleFields.includes('materialvariety')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="materialvariety">Material Variety of any</label>
                                <input type="text" id="materialvariety" formControlName="materialvariety"
                                    class="form-control">
                            </div>


                            <div *ngIf="visibleFields.includes('fabricPattern')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="fabricPattern">Fabric Pattern<span
                                        class="required">*</span></label>
                                <select name="fabricPattern" id="fabricPattern" class="form-select"
                                    formControlName="fabricPattern"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('fabricPattern')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allFabricPattern" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <!-- Validation feedback for the Fabric Pattern field -->
                                <div *ngIf="submittedStep1 && stepOne.get('fabricPattern')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('fabricPattern')?.hasError('required')">
                                        Fabric Pattern is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="visibleFields.includes('selectedOccasion')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="fitStyle">Occasion</label>
                                <p-multiSelect [options]="allOccasionType" placeholder="Select Occasion" optionLabel=""
                                    formControlName="selectedOccasion" class="custom-multiSelect"></p-multiSelect>
                            </div>

                            <div *ngIf="visibleFields.includes('selectedlifeStyle')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="lifeStyle">Life Style</label>
                                <p-multiSelect [options]="allLifeStyle" placeholder="Select Style" optionLabel=""
                                    formControlName="selectedlifeStyle" class="custom-multiSelect"></p-multiSelect>
                            </div>

                            <div *ngIf="visibleFields.includes('fitStyle')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="fitStyle">Fit Style<span
                                        class="required">*</span></label>
                                <select name="fitStyle" id="fitStyle" class="form-select" formControlName="fitStyle"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('fitStyle')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allFitStyle" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <!-- Validation feedback for the Fit Style field -->
                                <div *ngIf="submittedStep1 && stepOne.get('fitStyle')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('fitStyle')?.hasError('required')">
                                        Fit Style is required
                                    </div>
                                </div>
                            </div>


                            <div *ngIf="visibleFields.includes('neckStyle')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="neckStyle">Neck Style<span
                                        class="required">*</span></label>
                                <select name="neckStyle" id="neckStyle" class="form-select" formControlName="neckStyle"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('neckStyle')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allNeckStyle" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <div *ngIf="submittedStep1 && stepOne.get('neckStyle')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('neckStyle')?.hasError('required')">
                                        Neck Style is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="visibleFields.includes('closureType')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="closureType">Closure Type<span
                                        class="required">*</span></label>
                                <select name="closureType" id="closureType" class="form-select"
                                    formControlName="closureType"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('closureType')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allClosureType" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <div *ngIf="submittedStep1 && stepOne.get('closureType')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('closureType')?.hasError('required')">
                                        Closure Type is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="visibleFields.includes('pocketDescription')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="pocketDescription">Pocket Description<span
                                        class="required">*</span></label>
                                <select name="pocketDescription" id="pocketDescription" class="form-select"
                                    formControlName="pocketDescription"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('pocketDescription')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allPocketDiscription" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <div *ngIf="submittedStep1 && stepOne.get('pocketDescription')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('pocketDescription')?.hasError('required')">
                                        Pocket Description is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="visibleFields.includes('sleeveCuffStyle')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="sleeveCuffStyle">Sleeve Cuff Style<span
                                        class="required">*</span></label>
                                <select name="sleeveCuffStyle" id="sleeveCuffStyle" class="form-select"
                                    formControlName="sleeveCuffStyle"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('sleeveCuffStyle')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allSleeveCutStyle" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <div *ngIf="submittedStep1 && stepOne.get('sleeveCuffStyle')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('sleeveCuffStyle')?.hasError('required')">
                                        Sleeve Cuff Style is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="visibleFields.includes('sleeveLength')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="sleeveLength">Sleeve Length<span
                                        class="required">*</span></label>
                                <select name="sleeveLength" id="sleeveLength" class="form-select"
                                    formControlName="sleeveLength"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('sleeveLength')?.invalid}">
                                    <option value="" disabled selected>Select</option>
                                    <option *ngFor="let type of allSleeveLength" [value]="type.name">
                                        {{type.name}}
                                    </option>
                                </select>
                                <div *ngIf="submittedStep1 && stepOne.get('sleeveLength')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('sleeveLength')?.hasError('required')">
                                        Sleeve Length is required
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="visibleFields.includes('specialFeature')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="specialFeature">Special Feature</label>
                                <p-multiSelect [options]="allSpecialFeature" placeholder="Select" optionLabel=""
                                    formControlName="specialFeature" class="custom-multiSelect"></p-multiSelect>
                            </div>
                            <div *ngIf="visibleFields.includes('careInstructions')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="careInstructions">Care Instructions</label>
                                <select name="careInstructions" id="careInstructions" class="form-select"
                                    formControlName="careInstructions">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name" *ngFor="let type of allCareInstruction">{{type.name}}
                                    </option>
                                </select>
                            </div>
                            <!-- new fields -->
                            <div *ngIf="visibleFields.includes('seasons')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="seasons">Seasons</label>
                                <select name="seasons" id="seasons" class="form-select"
                                    formControlName="seasons">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name" *ngFor="let type of allCareInstruction">{{type.name}}
                                    </option>
                                </select>
                            </div>

                            <div *ngIf="visibleFields.includes('noOfPockets')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="noOfPockets">No Of Pockets</label>
                                <select name="noOfPockets" id="noOfPockets" class="form-select"
                                    formControlName="noOfPockets">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name" *ngFor="let type of allCareInstruction">{{type.name}}
                                    </option>
                                </select>
                            </div>

                            <div *ngIf="visibleFields.includes('noOfPockets')"
                                class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="noOfPockets">No Of Pockets</label>
                                <select name="noOfPockets" id="noOfPockets" class="form-select"
                                    formControlName="noOfPockets">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name" *ngFor="let type of allCareInstruction">{{type.name}}
                                    </option>
                                </select>
                            </div>

                            <div *ngIf="visibleFields.includes('scoksStyle')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="scoksStyle">Select scoksStyle</label>
                                <select name="scoksStyle" id="scoksStyle" class="form-select" 
                                    formControlName="scoksStyle">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>

                            <div *ngIf="visibleFields.includes('troursePocketDescription')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="troursePocketDescription">Select </label>
                                <select name="troursePocketDescription" id="troursePocketDescription" class="form-select" 
                                    formControlName="troursePocketDescription">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('layerCompression')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="layerCompression" id="layerCompression" class="form-select" 
                                    formControlName="layerCompression">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('Waistband')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="Waistband" id="Waistband" class="form-select" 
                                    formControlName="Waistband">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('includedComponents')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="includedComponents" id="includedComponents" class="form-select" 
                                    formControlName="includedComponents">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('riseStyle')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="riseStyle" id="riseStyle" class="form-select" 
                                    formControlName="riseStyle">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('trouserFitStyle')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="trouserFitStyle" id="trouserFitStyle" class="form-select" 
                                    formControlName="trouserFitStyle">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('troursePocket')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="troursePocket" id="troursePocket" class="form-select" 
                                    formControlName="troursePocket">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('trourseRiseStyle')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="trourseRiseStyle" id="trourseRiseStyle" class="form-select" 
                                    formControlName="trourseRiseStyle">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('trourseStyle')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="trourseStyle" id="trourseStyle" class="form-select" 
                                    formControlName="trourseStyle">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('trourseLength')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="trourseLength" id="trourseLength" class="form-select" 
                                    formControlName="trourseLength">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf="visibleFields.includes('coinPocket')" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="acb">Select </label>
                                <select name="coinPocket" id="coinPocket" class="form-select" 
                                    formControlName="coinPocket">
                                    <option value="" disabled selected>Select</option>
                                    <option [value]="type.name.code" *ngFor="let type of currencies">{{type.name.code}}
                                    </option>
                                </select>
                            </div>
                            
                        </div>
                        <!-- ===================== -->
                        
                        <div *ngIf="sizeSet?.length" class="m-0 p-4 border mt-2 pt-2 rounded" style="background-color: aliceblue;">
                            <div class="row">
                              <h5 class="mb-2 ps-0">Standard Size Set<span class="required">*</span></h5>
                              <div class="size-checkboxes">
                                <label class="me-4" *ngFor="let size of sizeSet">
                                  <input type="checkbox" [value]="size.size" (change)="onSizeChange($event, size.size)" 
                                         [checked]="selectedSizes.includes(size.size)" />
                                  {{ size.size }}
                                </label>
                              </div>
                            </div>
                          
                            <div *ngIf="sizesArray.controls.length > 0" class="row mt-2" formArrayName="sizes">
                              <h5 class="mt-4">{{foundSizeSet}} :</h5>
                              <hr>
                              <div class="col-12">                               
                                <div class="row mb-2">
                                  <div class="col" *ngFor="let field of sizeChartFields">
                                    <label class="custom-label">{{ field.label }}<span *ngIf="field.required" class="required">*</span></label>
                                  </div>
                                </div>
                              </div>
                              
                              <div class="col-12" *ngFor="let sizeGroup of sizesArray.controls; let i = index" [formGroupName]="i">
                                <div class="row">                         
                                  <div class="col" *ngFor="let field of sizeChartFields">
                                    <input type="text" [formControlName]="field.name" class="form-control custom-input" 
                                           [ngClass]="{'is-invalid': submittedStep1 && sizeGroup.get(field.name)?.invalid}" placeholder="">
                              
                                    <!-- Validation feedback -->
                                    <div *ngIf="submittedStep1 && sizeGroup.get(field.name)?.invalid" class="invalid-feedback">
                                      <div *ngIf="sizeGroup.get(field.name)?.hasError('required')">
                                        {{ field.label }} is required
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                            </div>                          
                              
                            
                          </div>
                          
                    <div *ngIf="showFlag2" class="total-data">
                        <div  class="row mt-2">                            
                            <div class="col-2">
                                <label for="setOFnetWeight">Total Weight<span class="required">*</span></label>
                                <input type="text" id="setOFnetWeight" formControlName="setOFnetWeight"
                                    class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('setOFnetWeight')?.invalid}">
                                <!-- Validation feedback for Net weight -->
                                <div *ngIf="submittedStep1 && stepOne.get('setOFnetWeight')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('setOFnetWeight')?.hasError('required')">
                                        Net weight is required
                                    </div>
                                </div>
                            </div>

                            <div class="col-2">
                                <label for="MRP">Total Manufacturer's Price<span
                                        class="required">*</span><span>({{selectedCurrency}})</span></label>
                                <input type="text" id="MRP" formControlName="setOfManPrice" class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('setOfManPrice')?.invalid}">

                                <div *ngIf="submittedStep1 && stepOne.get('setOfManPrice')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('setOfManPrice')?.hasError('required')">
                                        total Manufacturer Price is required
                                    </div>
                                </div>
                            </div>

                            <div class="col-2">
                                <label for="MRP">Total MRP<span class="required">*</span>
                                    <span>({{selectedCurrency}})</span></label>
                                <input type="text" id="setOfMRP" formControlName="setOfMRP" class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('setOfMRP')?.invalid}">

                                <div *ngIf="submittedStep1 && stepOne.get('setOfMRP')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('setOfMRP')?.hasError('required')">
                                        is required
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div  class="row mt-2">
                            <div class="col-2">
                                <label for="minimumOrderQty">Minimum Order Quantity<span
                                        class="required">*</span></label>
                                <input type="text" id="minimumOrderQty" formControlName="minimumOrderQty"
                                    class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('minimumOrderQty')?.invalid}">
                                <div *ngIf="submittedStep1 && stepOne.get('minimumOrderQty')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('minimumOrderQty')?.hasError('required')">
                                        Minimum Order Quantity is required
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="!ProductId"  class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="quantity">Total Quantity<span class="required">*</span>
                                    (in Sets)</label>
                                <input type="text" id="quantity" formControlName="quantity" class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('quantity')?.invalid}">
                                <div *ngIf="submittedStep1 && stepOne.get('quantity')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('quantity')?.hasError('required')">
                                        Quantity is required
                                    </div>
                                </div>
                            </div>
                            <!-- for new quantity -->
                            <div *ngIf="ProductId"  class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="newQuantity">New Quantity<span class="required">*</span>
                                    (in Sets)</label>
                                <input type="text" id="newQuantity" formControlName="newQuantity" class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('newQuantity')?.invalid}">
                                <div *ngIf="submittedStep1 && stepOne.get('newQuantity')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('newQuantity')?.hasError('required')">
                                        New Quantity is required
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="!ProductId" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="productTitle">Date Of Manufacture<span
                                        class="required">*</span></label>
                                <input type="date" id="dateOfManufacture" formControlName="dateOfManufacture"
                                    class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('dateOfManufacture')?.invalid}">

                                <div *ngIf="submittedStep1 && stepOne.get('dateOfManufacture')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('dateOfManufacture')?.hasError('required')">
                                        Date Of Manufacture is required
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="!ProductId" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="dateOfListing">Date Of Listing<span
                                        class="required">*</span></label>
                                <input type="date" id="dateOfListing" formControlName="dateOfListing"
                                    class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('dateOfListing')?.invalid}">
                                <!-- Validation feedback for the Product Title field -->
                                <div *ngIf="submittedStep1 && stepOne.get('dateOfListing')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('dateOfListing')?.hasError('required')">
                                        Date Of Listing is required
                                    </div>
                                </div>
                            </div>

                            <!-- forUpdate -->
                            <div *ngIf="ProductId" class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="updatedDate">Updated Date<span
                                        class="required">*</span></label>
                                <input type="date" id="updatedDate" formControlName="updatedDate"
                                    class="form-control"
                                    [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('updatedDate')?.invalid}">
                                <!-- Validation feedback for the Product Title field -->
                                <div *ngIf="submittedStep1 && stepOne.get('updatedDate')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('updatedDate')?.hasError('required')">
                                        Updated Date is required
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3">
                                <label class="label-input" for="alertStock">Minimum Alert Stock<span
                                        class="required">*</span></label>
                                <input type="text" id="alertStock" formControlName="alertStock"
                                    class="form-control" [ngClass]="{'is-invalid': submittedStep1 && stepOne.get('alertStock')?.invalid}">
                                <!-- Validation feedback for the Product Title field -->
                                <div *ngIf="submittedStep1 && stepOne.get('alertStock')?.invalid"
                                    class="invalid-feedback">
                                    <div *ngIf="stepOne.get('alertStock')?.hasError('required')">
                                        Alert Stock is required
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                        <!-- } -->
                    </div>

                    <div class="d-flex justify-content-center  mt-4">
                        <button type="button" class="btn submit-btn me-2" (click)="nextStep()">Save and Next >></button>
                    </div>

                </div>

                <div *ngIf="currentStep === 2" class="">
                    <div [formGroup]="stepTwo" class="border p-4 rounded" style="background-color: aliceblue;">
                        <h5>Add Color Collection:</h5>
                        <div class="row">
                            <!-- Color Code -->
                            <div class="col-2">
                                <label for="colorCode">Color Code<span *ngIf="colourCollections.length > 0"
                                        class="required">*</span></label>
                                <input type="color" id="colorCode" formControlName="colour"
                                    class="form-control color-input">
                                <div *ngIf="submittedStep2 && stepTwo.get('colour')?.invalid" class="text-danger">
                                    Color Code is required
                                </div>
                            </div>

                            <!-- Color Name -->
                            <div class="col-2">
                                <label for="colorName">Color Name<span class="required">*</span></label>
                                <input type="text" id="colorName" formControlName="colourName" class="form-control"
                                    placeholder="Color Name">
                                <div *ngIf="submittedStep2 && stepTwo.get('colourName')?.invalid" class="text-danger">
                                    Color Name is required
                                </div>
                            </div>

                            <!-- Color Image -->
                            <div class="col-2">
                                <label for="colourImage">Product Icon<span *ngIf="colourCollections.length === 0"
                                        class="required">*</span></label>
                                <input type="file" id="colourImage" (change)="onFileChange($event, 'colourImage')"
                                    class="form-control file-input">
                                <div *ngIf="submittedStep2 && stepTwo.get('colourImage')?.invalid" class="text-danger">
                                    Product Icon is required
                                </div>
                            </div>

                            <!-- Product Video -->
                            <div class="col-3">
                                <label for="videoUpload">Product Video</label>
                                <input type="file" id="videoUpload" class="form-control file-input"
                                    (change)="onFileChange($event, 'productVideo')" accept="video/*">
                                <div *ngIf="submittedStep2 && stepTwo.get('productVideo')?.invalid" class="text-danger">
                                    Product Video is required
                                </div>
                                <div *ngIf="videoSizeError" class="text-danger">
                                    {{ videoSizeError }}
                                </div>
                            </div>
                        </div>

                        <!-- For Product Images -->
                        <div class="row">
                            <div class="col-12">
                                <label for="">Add Product Images<span *ngIf="colourCollections.length === 0"
                                        class="required">*</span> &nbsp;<small style="color: brown;">(max 5 images
                                        add)</small></label>
                                <div class="d-flex flex-wrap align-items-center product-box">
                                    <div *ngFor="let image of productImages.controls; let i = index"
                                        class="position-relative m-1 image-container">
                                        <img [src]="image.value ? createObjectURL(image.value) : ''" alt="Product Image"
                                            class="image-preview">
                                        <button type="button" class="cancel-button"
                                            (click)="removeProductImage(i)">X</button>
                                    </div>
                                    <button *ngIf="productImages.length < 5" type="button" class="add-image-button"
                                        (click)="triggerFileInput()">
                                        <i class="bi bi-plus-square-dotted"></i>
                                    </button>
                                    <input type="file" id="productImageInput" (change)="onProductImageChange($event)"
                                        hidden>
                                </div>
                                <div *ngIf="colourCollections.length === 0 && productImages.length === 0 && submittedStep2"
                                    class="text-danger mt-2">
                                    At least one product image is required
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-center mt-3">
                            <button type="submit" class="btn submit-btn d-flex" (click)="saveStepTwoData()">
                                <i class="bi bi-plus"></i> Add New Color
                            </button>
                        </div>
                    </div>

                    <!-- show added color collection -->
                    <div class="border p-4 rounded mt-4" [ngClass]="colourCollections?.length > 0 ? '' :'d-none'">
                        <h5>Added Colour-Collection</h5>
                        <div class="table-container rounded">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Sr. NO.</th>
                                        <th>Colour Name</th>
                                        <th>Icon Image</th>
                                        <th>Product Video</th>
                                        <th>Product Images</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let collection of colourCollections; let i = index">
                                        <td>{{ i + 1 }}</td>
                                        <td>{{ collection.colourName | titlecase }}</td>
                                        <td>
                                            <ng-container *ngIf="collection.colourImage; else colorImageFallback">
                                                <img [src]="getColorIconPath(collection.colourImage)" alt="Color Icon">
                                            </ng-container>
                                            <ng-template #colorImageFallback>
                                                <span [style.background]="collection.colour" class="colour-hex"></span>
                                              </ng-template>
                                        </td>
                                        <td>
                                            <ng-container *ngIf="collection.productVideo; else noVideo">
                                                <video controls [src]="getVideoPath(collection.productVideo)"></video>
                                            </ng-container>
                                            <ng-template #noVideo>
                                                Not Video
                                            </ng-template>
                                            
                                        </td>
                                        <td>
                                            <div class="product-images">
                                                <ng-container *ngIf="collection.productImages.length; else noImages">
                                                    <img *ngFor="let image of collection.productImages"
                                                        [src]="getProductImagePath(image)" alt="Product Image">
                                                </ng-container>
                                                <ng-template #noImages>
                                                    No Images Available
                                                </ng-template>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-icon p-2" pTooltip="Edit"
                                                (click)="deleteColorCOllection(collection)" tooltipPosition="top">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>